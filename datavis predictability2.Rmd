---
title: "Data Visualization Project 2"
author: "Stephanie"
date: "4/16/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(install.load)
install_load('R.matlab')
#install_load('plotly')
```

## Reality Mining Predictability 

Subject 10 considers themselves very predictable. I'll work to implment two visualizations on this subject to determine if their schedule is truly predictable or not. 

```{r cars}
HOME <- '1'
WORK <- '2'
ELSEWHERE <- '3'
NO_SIGNAL <- '4'
PHONE_OFF <- NaN

load(file = "data/s10data.Rda")
s10data <- as.data.frame(s10data)

colnames(s10data) <- c("Date", as.character(1:24))
rownames(s10data) <- c(seq(1:140))

start_date <- as.POSIXct((732200 - 719529)*86400, origin = "1970-01-01")
end_date <- as.POSIXct((732339.905636574 - 719529)*86400, origin = "1970-01-01")
```


```{r}
s10data$Date <- as.Date(s10data$Date, format = "%m/%d/%Y")
s10data$day <- weekdays(as.Date(s10data$Date))
```

I need a new data frame where the probabilities are calculated in the cells. 

```{r}
#example of 24th hour probability for friday

days_of_week <- c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")

total_friday <- sum(s10data$day == "Friday")

total_home_friday <- sum(s10data$day == "Friday" & s10data$'24'==HOME)

probability <- total_home_friday/total_friday

```
I should probably create a function to do these probabilities quickly and at once.. below I will work to create this function.


This function takes in the day of the week and the location we want to compute the probability for. 


```{r}



func4 <- function(input_day, location) {
    vr <- c() ### an empty vector 
    probability_skeleton <- data.frame()
    for (j in 1:length(input_day)){
        for (i in 1:24) { 
      
        total_day <- sum(s10data$day == input_day)
        total_instance <- sum(s10data$day == input_day & s10data[,i+1]== location)
        probability <- total_instance/total_day
        
        vr[i] <- probability
        
        }
        
        
    }
    vr
}



hold <-func4("Monday","2")

hold[3]
```

I'm going to create a data from for the probability that the person is 1-home 2-work 3-elsewhere, below is the example for the probability the subject is at home 

```{r}

d <- data.frame(matrix(nrow=24, ncol=7))

for (i in 1:length(days_of_week)){
  
  d[,i] <- cbind(func4(days_of_week[i], HOME))
  
}

colnames(d) <- days_of_week

heatmap_home <- heatmap(as.matrix(d), Rowv=NA, Colv=NA, col = cm.colors(256),scale="none", margins=c(5,10))


```


The subject is at work 

```{r}
d2 <- data.frame(matrix(nrow=7, ncol=24))

for (i in 1:length(days_of_week)){
  
  d2[i,] <- rbind(func4(days_of_week[i], WORK))
  
}

rownames(d2) <- days_of_week

heatmap_work <- heatmap(as.matrix(d2), Rowv=NA, Colv=NA, col = cm.colors(256),scale="none", margins=c(5,10))


```

The subject is else where 

```{r}
d3 <- data.frame(matrix(nrow=7, ncol=24))

for (i in 1:length(days_of_week)){
  
  d3[i,] <- rbind(func4(days_of_week[i], ELSEWHERE))
  
}

rownames(d3) <- days_of_week
heatmap_elsewhere <- heatmap(as.matrix(d3), Rowv=NA, Colv=NA, col = cm.colors(256),scale="none", margins=c(5,10))
```

Next I'm going to work on creating heatmaps for each place

```{r}

p <- plot_ly(z=d3, type = "heatmap")
p
heatmap(d3)

#confidence band, variance 
#measure of standard error 
#(time series)
#narrative transition

```



How will these probability heatmaps look for someone who doesnt consider themselves predictable? 

```{r}

```

