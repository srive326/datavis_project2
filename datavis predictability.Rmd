---
title: "Datavis project2"
author: "Stephanie"
date: "4/16/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install_load(install.load)
install_load('R.matlab')
```

## Reality Mining Predictability 

Subject 10 considers themselves very predictable. I'll work to implment two visualizations on this subject to determine if their schedule is truly predictable or not. 

```{r cars}

s10data <- as.data.frame(t(s10data))
colnames(s10data) <- c("Date", seq(1:24))
rownames(s10data) <- c(seq(1:140))
as.character(colnames(s10data))
start_date <- as.POSIXct((732200 - 719529)*86400, origin = "1970-01-01")
end_date <- as.POSIXct((732339.905636574 - 719529)*86400, origin = "1970-01-01")
```



```{r}
s10data$Date <- as.Date(s10data$Date, format = "%m/%d/%Y")
s10data$days <- weekdays(as.Date(s10data$Date))


```

I need a new data frame where the probabilities are calculated in the cells. 

```{r}
#example of 24th hour probability for friday

days_of_week <- c("Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday")

total_friday <- sum(s10data$days == "Friday")

total_home_friday <- sum(s10data$days == "Friday" & s10data$'24'=='1')

probability <- total_home_friday/total_friday

```
I should probably create a function to do these probabilities quickly and at once.. below I will work to create this function.

```{r}
#function to get the probability of being home on a friday for each hour in a day 


func2 <- function(input_day) {
    vr <- c() ### an empty vector 

    for (i in 1:24) { 
      
        total_day <- sum(s10data$days == input_day)
        total_instance <- sum(s10data$days == input_day & s10data[,i+1]== '1')
        probability <- total_instance/total_day
        
        vr[i] <- probability
        
    }
    vr
}

func2("Friday")

```

This function takes in the day of the week and the location we want to compute the probability for. 

```{r}


  
func3 <- function(input_day, location) {
    vr <- c() ### an empty vector 

    for (i in 1:24) { 
      
        total_day <- sum(s10data$days == input_day)
        total_instance <- sum(s10data$days == input_day & s10data[,i+1]== location)
        probability <- total_instance/total_day
        
        vr[i] <- probability
        
    }
    vr
}

func3("Friday","2")

```


```{r}



func4 <- function(input_day, location) {
    vr <- c() ### an empty vector 
    probability_skeleton <- data.frame()
    for (j in 1:length(input_day)){
        for (i in 1:24) { 
      
        total_day <- sum(s10data$days == input_day)
        total_instance <- sum(s10data$days == input_day & s10data[,i+1]== location)
        probability <- total_instance/total_day
        
        vr[i] <- probability
        
        }
        
        
    }
    vr
}



hold <-func4("Monday","2")

hold[3]
```



```{r}

```

